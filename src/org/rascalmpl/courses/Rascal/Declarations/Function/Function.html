<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
  <html xmlns="http://www.w3.org/1999/xhtml">

<!---- DO NOT EDIT: HTML generated by CourseCompiler ---->


<head>
<title>Rascal/Declarations/Function</title>

<meta name="description" content="Rascal/Declarations/Function:  Declare a function.">

<meta name="keywords" content="Rascal/Declarations/Function, Rascal, meta-programming, software analysis, software transformation">
<link type="text/css" rel="stylesheet" href="/prelude.css"/>
<link type="text/css" rel="stylesheet" href="/jquery.autocomplete.css"/>
<script type="text/javascript" src="/jquery-1.4.2.min.js"></script>
<script type="text/javascript" src="/jquery.colorbox-min.js"></script>
<script type="text/javascript" src="/jquery.cookie.js"></script>
<script type="text/javascript" src="/jquery.jstree.js"></script>
<script type="text/javascript" src="/jquery.autocomplete.js"></script>
<script type="text/javascript" src="/jquery.history.js"></script>
<script type="text/javascript" src="/globals.js"></script>
<script type="text/javascript" src="/prelude.js"></script>
<script type="text/javascript" src="/Rascal/course.js"></script>

</head>
<body>
<table id="container"><tr><td id="tdlogo"><a id="tutorAction" href="/index.html"><img id="leftIcon" height="40" width="40" src="/images/rascal-tutor-small.png"></a></td><td id="tdsearch">
<div id="searchBox">
  <form method="GET" id="searchForm" action="/search"> 
    <img id="searchIcon" height="20" width="20" src="/images/magnify.png">
    <input type="hidden" name="concept" value="Rascal/Declarations/Function">
    <input type="text" id="searchField" name="term" autocomplete="off"><br />
    <div id="popups"></div>
  </form>
</div>
         </td></tr><tr><td id="tdnav">
<a id="navPanePlaceHolder" href="/Rascal/navigate.html" >Navigation</a>
<script type="text/javascript"> var navigationPaneSource="/Rascal/navigate.html"; </script></td><td id="tdconcept">
<div id="conceptPane">

<div id="Name">
<span class="sectionHead">Name</span> <a href="/Rascal/Rascal.html">Rascal</a>/<a href="/Rascal/Declarations/Declarations.html">Declarations</a>/<a href="/Rascal/Declarations/Function/Function.html">Function</a>
</div>

<div id="Synopsis">
<span class="sectionHead">Synopsis</span>  Declare a function.

</div>

	                       
<div id="Syntax">
<span class="sectionHead">Syntax</span>  <ol><li> <code><i>Modifiers</i> <i>Type</i> <i>Name</i>( <i>Type</i><sub>1</sub> <i>Var</i><sub>1</sub>, ..., <i>Type</i><sub>n</sub> <i>Var</i><sub>n</sub> ) <i>Body</i></code></li>
<li> <code><i>Modifiers</i> <i>Type</i> <i>Name</i>( <i>Type</i><sub>1</sub> <i>Var</i><sub>1</sub>, ..., <i>Type</i><sub>n</sub> <i>Var</i><sub>n</sub> <i>Type</i><sub>0</sub> <i>Name</i><sub>0</sub>... ) <i>Body</i></code></li>
<li> <code><i>Modifiers</i> <i>Type</i> <i>Name</i>( <i>Pattern</i><sub>1</sub>, ..., <i>Pattern</i><sub>n</sub>) <i>Body</i></code></li>
<li> <code><i>Modifiers</i> <i>Type</i> <i>Name</i>( <i>Pattern</i><sub>1</sub>, ..., <i>Pattern</i><sub>n</sub>, <i>Type</i><sub>0</sub> <i>Name</i><sub>0</sub>...) <i>Body</i></code></li>
</ol> where <code><i>Body</i></code> is one of:
 <ul><li> <code>{ <i>Statements</i> }</code></li>
<li> <code>throws <i>Exception</i><sub>1</sub>, <i>Exception</i><sub>2</sub>, ... { <i>Statements</i> }</code></li>
<li> <code> = <i>Expression</i>;</code></li>
</ul> and where <code><i>Modifiers</i></code> may be:
 <ul><li> <code>("public" | "private")? ("java" | "test" | "default")?</code></li>
</ul>
</div>

                           
                           
                           
<div id="Description">
<span class="sectionHead">Description</span>  <h2> Variant 1 </h2>
 A function declaration introduces a new function with name <code><i>Name</i></code>, typed formal parameters <code><i>Type</i><sub>1</sub> <i>Var</i><sub>1</sub></code>, a return type <code><i>Type</i></code>
 and a <code><i>Statement</i></code> that forms the function body.
 The type of <code><i>Statement</i></code> should be equal to <code><i>Type</i></code>.
 <br/>
<br/>

 The formal parameters may be used in <code><i>Statement</i></code> and get their value when function <code><i>Name</i></code> is invoked.
  <h2> Variant 2 </h2>
 A function may have a variable list of arguments, this has as syntax variant 2 given above.
 <br/>
<br/>

 The last parameter of a function may be followed by <code>...</code> and this has as effect that all remaining actual parameters
 that occur in a call to this function are collected as list value of the last formal parameter. 
 Inside the function body, the type of this parameter will therefore be <code>list[<i>Type</i><sub>0</sub>]</code>.
  <h2> Variant 3 and 4 </h2>
 All formal parameter of a function can be <a href="/Rascal/Patterns/Patterns.html">Patterns</a>. There are some restrictions however:
 <ul><li> <a href="/Rascal/Patterns/Patterns.html">Patterns</a> in formal parameter positions may not refer to variables in the scope</li>
<li> <a href="/Rascal/Patterns/Patterns.html">Patterns</a> in formal parameter positions may not introduce fresh variables without an explicit type. </li>
<li> The last parameter, if followed by <code>...</code> can only be a normal typed parameters, not just any pattern.</li>
</ul> <h2> Body types </h2>
 <ul><li> Functions with list of statements as bodies must eventually use <code>return</code> or <code>fail</code> on every control flow path. </li>
<li> The declarations to <code>throw</code> an exception are documentation only</li>
<li> Single expressions can be bodies of functions, the return value is the value of the expression.</li>
</ul> <h2> Parameterized types in function declaration </h2>
 The types that occur in function declarations may also contain <a href="/Rascal/Declarations/StaticTyping/TypeParameters/TypeParameters.html">TypeParameters</a>.
 In this way functions can be defined for arbitrary types. The type variable is bound (statically) at by the types of the parameters given at location of the call. The result type must be used at least once in any of the parameters.
  <h2> Overloading </h2>
 Function definitions may be overloaded, i.e. a function with the same name may be defined twice and a function may redefine a constructor of an <a href="/Rascal/Declarations/AlgebraicDataType/AlgebraicDataType.html">AlgebraicDataType</a> or a <a href="/Rascal/Declarations/SyntaxDefinition/SyntaxDefinition.html">SyntaxDefinition</a>.
 <br/>
<br/>

 There are some restrictions however:
 <ul><li> Overloaded alternatives for the same function name but with different patterns must return the same type.</li>
<li> Overloaded alternatives for the same function name must have mutually exclusive patterns, unless one alternative is labeled <code>default</code> and the other is not. The patterns of formal parameters are mutually exclusive if for at least one parameter position: <ul><li> They range over incomparable types, as in <code>int f(int a)</code> and <code>int f(real a)</code>, or</li>
<li> They range over different alternatives of an <a href="/Rascal/Declarations/AlgebraicDataType/AlgebraicDataType.html">AlgebraicDataType</a>, as in <code>int f(and(Bool a, Bool b))</code> and <code>int f(or(Bool a, Bool b))</code></li>
<li> They range over different alternatives of a <a href="/Rascal/Declarations/SyntaxDefinition/SyntaxDefinition.html">SyntaxDefinition</a></li>
<li> And note that deep matches using the <code>/</code> alternative are considered to be of type <code>value</code> and therefore overlap with all other patterns.</li>
</ul></li>
<li> Overlapping patterns are allowed if the one alternative has the <code>default</code> modified while the other does not.</li>
<li> If a function is fallible, it uses the <code>fail</code> statement to back-track to a different alternative, then there must be a <code>default</code> alternative defined which can handle the general case. An <a href="/Rascal/Declarations/AlgebraicDataType/AlgebraicDataType.html">AlgebraicDataType</a> or a <a href="/Rascal/Declarations/SyntaxDefinition/SyntaxDefinition.html">SyntaxDefinition</a> with the same name and return type counts as a <code>default</code> alternative.</li>
<li> <code>default</code> functions may not fail.</li>
</ul> <h2> Modifiers </h2>
 The <code><i>Modifiers</i></code> affect <i>visibility</i> and <i>special behaviour</i> of functions:
 <ul><li> <i>Visibility</i>: <code>private</code> declares that a function is only visible in the current module.    <code>public</code> declares that it is visible outside the module as well. When visibility is not specified, <code>private</code> is assumed.
</li>
<li> <i> Special Behaviour</i>:</li>
<li> <code>java</code> declares that the body of the function is implemented in Java. The function should have a     <code>javaClass</code> annotation that determines where the Java implementation can be found.
</li>
<li> <code>test</code> declares that this is a test function. A test function is a boolean function (currently) without arguments.      It can be called as any other function. However, it can also be called automatically
     by the unit test framework, by typing <code>:test</code> at the command line, see <a href="/Rascal/InstallingAndRunning/Running/Help/Help.html">Help</a>.
</li>
<li> <code>default</code> declares an alternative for an overloaded function that will only be tried after all non-default alternatives have been tried. Note that <a href="/Rascal/Declarations/AlgebraicDataType/AlgebraicDataType.html">AlgebraicDataType</a>s and <a href="/Rascal/Declarations/SyntaxDefinition/SyntaxDefinition.html">SyntaxDefinition</a>s <i>implicitly</i> define <code>default</code> functions that may be overloaded by normal <a href="/Rascal/Declarations/Function/Function.html">Function</a>s.</li>
</ul>
</div>

  	                       
<div id="Examples">
<span class="sectionHead">Examples</span>    Declare a function
<pre class="screen"><span class="prompt">rascal></span>rel[int, int] invert(rel[int,int] R){
<span class="continuation">>>>>>>></span>   return {&lt;Y, X> | &lt;int X, int Y> &lt;- R };
<span class="continuation">>>>>>>></span>}
rel[int, int] (rel[int, int]): rel[int, int] invert(rel[int, int]);
</pre>  Call it
<pre class="screen"><span class="prompt">rascal></span>invert({&lt;1,10&gt;, &lt;2,20&gt;});
rel[int, int]: {
  &lt;20,2>,
  &lt;10,1>
}
</pre> In the following example we illustrate the use of type variables in function declarations.
 Declare an inversion function that is applicable to any binary relation:
 <pre class="screen"><span class="prompt">rascal></span>rel[&amp;T2, &amp;T1] invert2(rel[&amp;T1,&amp;T2] R){  
<span class="continuation">>>>>>>></span>   return {&lt;Y, X> | &lt;&amp;T1 X, &amp;T2 Y> &lt;- R };
<span class="continuation">>>>>>>></span>}
rel[&amp;T2, &amp;T1] (rel[&amp;T1, &amp;T2]): rel[&amp;T2, &amp;T1] invert2(rel[&amp;T1, &amp;T2]);
</pre> Now apply it to relations with different types:
<pre class="screen"><span class="prompt">rascal></span>invert2({&lt;1,10&gt;, &lt;2,20&gt;});
rel[int, int]: {
  &lt;20,2>,
  &lt;10,1>
}
<span class="prompt">rascal></span>invert2({&lt;&quot;mon&quot;, 1&gt;, &lt;&quot;tue&quot;, 2&gt;});
rel[int, str]: {
  &lt;1,"mon">,
  &lt;2,"tue">
}
</pre>  As another example declare a function that can be used to swap the elements of pairs of arbitrary types
  (also see <a href="/Rascal/Expressions/Values/Tuple/Subscription/Subscription.html">Tuple/Subscription</a>):
<pre class="screen"><span class="prompt">rascal></span>tuple[&amp;T2, &amp;T1] swap(tuple[&amp;T1, &amp;T2] TP) { return &lt;TP[1], TP[0]&gt;;}
tuple[&amp;T2,&amp;T1] (tuple[&amp;T1,&amp;T2]): tuple[&amp;T2,&amp;T1] swap(tuple[&amp;T1,&amp;T2]);
<span class="prompt">rascal></span>swap(&lt;1, 2&gt;);
tuple[int,int]: &lt;2,1>
<span class="prompt">rascal></span>swap(&lt;&quot;wed&quot;, 3&gt;);
tuple[int,str]: &lt;3,"wed">
</pre> Here we use an overloaded definition with incomparable patterns:
 <pre class="screen"><span class="prompt">rascal></span>int f(int i) = 1;
int (int): int f(int);
<span class="prompt">rascal></span>int f(real r) = 2;
int (real): int f(real);
<span class="prompt">rascal></span>f(0);
int: 1
<span class="prompt">rascal></span>f(0.0);
int: 2
</pre> And we may use <code>default</code>, as in:
 <pre class="screen"><span class="prompt">rascal></span>int f(0) = 1;
int (int): int f(int);
<span class="prompt">rascal></span>default int f(int n) = n * f(n - 1);
int (int): int f(int);
<span class="prompt">rascal></span>f(0);
int: 1
<span class="prompt">rascal></span>f(2);
int: 2
</pre> In combination with an <a href="/Rascal/Declarations/AlgebraicDataType/AlgebraicDataType.html">AlgebraicDataType</a>, which defines <code>default</code> functions implicitly for every alternative, we can define canonicalization functions. The same holds for <a href="/Rascal/Declarations/SyntaxDefinition/SyntaxDefinition.html">SyntaxDefinition</a>s, see <a href="/Rascal/Declarations/SyntaxDefinition/Action/Action.html">Action</a>s.
   This definition implies a default function for t(), f() and neg(B):
<pre class="screen"><span class="prompt">rascal></span>data B = t() | f() | neg(B);
ok
</pre>  the following definition will remove any nested neg before it is even constructed:
<pre class="screen"><span class="prompt">rascal></span>B neg(neg(B b)) = b;
B (B): B neg(B);
<span class="prompt">rascal></span>neg(t());
B: neg(t())
<span class="prompt">rascal></span>neg(neg(f()));
B: f()
</pre>
</div>

  	                       
  	                       
  	                       
<a id="tutorAction" href="/index.html"><img id="leftIcon" height="40" width="40" src="/images/rascal-tutor-small.png"></a><div id="editMenu">[<a id="editAction" href="/edit?concept=Rascal/Declarations/Function&new=false"><b>Edit</b></a>] | 
               [<a id="newAction" href="/edit?concept=Rascal/Declarations/Function&new=true"><b>New Subconcept</b></a>] |
               [<a id="compileAction" href="/compile?name=Rascal"><b>Recompile Course</b></a>] |
               [<a id="warnAction" href="/Rascal/warnings.html"><b>Warnings</b></a>]</div>
<span class="editMenuFooter">Is this page unclear, or have you spotted an error? Please add a comment below and help us to improve it. For all other questions and remarks, visit <a href="http://ask.rascal-mpl.org">ask.rascal-mpl.org</a>. </span>
</div>
</td></tr></table>
</body>
</html>