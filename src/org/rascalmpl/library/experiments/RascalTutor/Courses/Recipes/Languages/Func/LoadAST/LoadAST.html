<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
  <html xmlns="http://www.w3.org/1999/xhtml">

<!---- DO NOT EDIT: HTML generated by CourseCompiler ---->


<head>
<title>Recipes/Languages/Func/LoadAST</title>
<link type="text/css" rel="stylesheet" href="/Courses/prelude.css"/>
<link type="text/css" rel="stylesheet" href="/Courses/jquery.autocomplete.css"/>
<script type="text/javascript" src="/Courses/jquery-1.4.2.min.js"></script>
<script type="text/javascript" src="/Courses/jquery.cookie.js"></script>
<script type="text/javascript" src="/Courses/jquery.jstree.js"></script>
<script type="text/javascript" src="/Courses/jquery.autocomplete.js"></script>
<script type="text/javascript" src="/Courses/jquery.history.js"></script>
<script type="text/javascript" src="/Courses/globals.js"></script>
<script type="text/javascript" src="/Courses/prelude.js"></script>
<script type="text/javascript" src="/Courses/Recipes/course.js"></script>

</head>
<body>
<a id="tutorAction" href="/Courses/index.html"><img id="leftIcon" height="40" width="40" src="/Courses/images/rascal-tutor-small.png"></a><table id="container"><tr><td id="tdnav">
<div id="navPanePlaceHolder">

</div>
<script type="text/javascript"> var navigationPaneSource="/Courses/Recipes/navigate.html"; </script></td><td id="tdconcept">
<div id="conceptPane">

<div id="Name">
<span class="sectionHead">Name</span> <a href="/Courses/Recipes/Recipes.html">Recipes</a>/<a href="/Courses/Recipes/Languages/Languages.html">Languages</a>/<a href="/Courses/Recipes/Languages/Func/Func.html">Func</a>/<a href="/Courses/Recipes/Languages/Func/LoadAST/LoadAST.html">LoadAST</a>
</div>

<div id="searchBox">
  <form method="GET" id="searchForm" action="/search"> 
    <img id="searchIcon" height="20" width="20" src="/Courses/images/magnify.png">
    <input type="hidden" name="concept" value="Recipes/Languages/Func/LoadAST">
    <input type="text" id="searchField" name="term" autocomplete="off"><br />
    <div id="popups"></div>
  </form>
</div>
         
<div id="Synopsis">
<span class="sectionHead">Synopsis</span>  Parse Func program from string or file and convert to an abstract syntax tree.

</div>

<div id="Description">
<span class="sectionHead">Description</span>  To simplify later processing, Func programs are converted to an abstract syntax tree.

</div>

<div id="Examples">
<span class="sectionHead">Examples</span>  The concrete syntax for Func is described in Func/ConcreteSyntax and its
 abstract syntax in <a href="/Courses/Recipes/Languages/Func/AbstractSyntax/AbstractSyntax.html">Func/AbstractSyntax</a>.
 Rather than manually writing conversion rules from Func parse trees to Func abstract syntax trees
 we use our secret weapon: <a href="/Courses/Rascal/Libraries/ParseTree/implode/implode.html">implode</a> that performs the mapping for us.
 As you see when you compare the concrete and abstract syntax, the ground work has already been done
 by appropriately labelling concrete rules with constructor names of the abstract syntax.
 <br/>
<br/>

 Here is the code for the <code>load</code> funcion:
  <pre class="listing">module demo::lang::Func::Load

import demo::lang::Func::Func;
import demo::lang::Func::AST;
import demo::lang::Func::Parse;

import ParseTree;

public demo::lang::Func::AST::Prog implode(demo::lang::Func::Func::Prog p) = 
       implode(#demo::lang::Func::AST::Prog, p);

public demo::lang::Func::AST::Prog load(loc l) = implode(parse(l));
public demo::lang::Func::AST::Prog load(str s) = implode(parse(s));

</pre> This looks simple but also slightly intimidating due to the many qualified names.
 The issue is that the names in the concrete and abstract syntax are (on purpose) overloaded.
 A name like <code>Prog</code> can be the one from the concrete syntax(i.e., <code>demo::lang::Func::Func::Prog</code>)
 or the one from the abstract syntax (i.e., <code>demo::lang::Func::AST::Prog</code>).
 <br/>
<br/>

 For instance, the local version of <code>implode</code> defined here get a concrete <code>Prog</code> as argument and returns an abstract one.
 Both <code>load</code> function return an abstract <code>Prog</code>.
 <br/>
<br/>

 Let's try this on example <code>F0</code>:
 <pre class="listing">fact(n) = if n &lt;= 1 then
             1 
          else 
             n * fact(n-1)
          end
</pre> <pre class="screen"><b>rascal></b>import demo::lang::Func::Load;
ok
<b>rascal></b>import demo::lang::Func::programs::F0;
ok
<b>rascal></b>load(F0);
Prog: prog([func(
      &quot;fact&quot;,
      [&quot;n&quot;],
      cond(
        leq(
          var(&quot;n&quot;)[
            @location=|file://-|(13,1,&lt;1,13&gt;,&lt;1,14&gt;)
          ],
          nat(1)[
            @location=|file:/...
</pre>
  We get the original program and its <b>abstract syntax tree</b> of type <code>Prog</code> back.
  In case of doubt, compare this with the result in <a href="/Courses/Recipes/Languages/Func/Parse/Parse.html">Func/Parse</a> where we did obtain a parse tree.
  Next, we try the same from a file.

<pre class="screen"><b>rascal></b>load(|std://demo/lang/Func/programs/F0.func|);
Uncaught Rascal Exception: std:///demo/lang/Func/Parse.rsc:6,27: IO(&quot;std://demo/&raquo;
lang/Func/programs/F0.func&quot;)
    somewhere in: parse
    somewhere in: load
    somewhere in: $shell$
</pre>
</div>

<a id="tutorAction" href="/Courses/index.html"><img id="leftIcon" height="40" width="40" src="/Courses/images/rascal-tutor-small.png"></a><div id="editMenu">[<a id="editAction" href="/edit?concept=Recipes/Languages/Func/LoadAST&new=false"><b>Edit</b></a>] | 
               [<a id="newAction" href="/edit?concept=Recipes/Languages/Func/LoadAST&new=true"><b>New Subconcept</b></a>] |
               [<a id="compileAction" href="/compile?name=Recipes"><b>Compile Course</b></a>] |
               [<a id="compileAction" href="/compile?name=Recipes&flags=regenerate"><b>Recompile Course</b></a>] |
               [<a id="warnAction" href="/Courses/Recipes/warnings.html"><b>Warnings</b></a>]</div>

</div>
</td></tr></table>
</body>
</html>