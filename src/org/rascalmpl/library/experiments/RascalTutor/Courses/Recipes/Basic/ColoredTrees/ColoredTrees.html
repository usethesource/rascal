<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
  <html xmlns="http://www.w3.org/1999/xhtml">

<!---- DO NOT EDIT: HTML generated by CourseCompiler ---->


<head>
<title>Recipes/Basic/ColoredTrees</title>
<link type="text/css" rel="stylesheet" href="/Courses/prelude.css"/>
<script type="text/javascript" src="/Courses/jquery-1.4.2.min.js"></script>
<script type="text/javascript" src="/Courses/jquery.cookie.js"></script>
<script type="text/javascript" src="/Courses/jquery.jstree.js"></script>
<script type="text/javascript" src="/Courses/prelude.js"></script>
<script type="text/javascript" src="/Courses/Recipes/course.js"></script>

</head>
<body>
<a id="tutorAction" href="/Courses/index.html"><img id="leftIcon" height="40" width="40" src="/images/rascal-tutor-small.png"></a><table id="container"><tr><td id="tdnav">
<div id="navPane">
<ul><li><a href="/Courses/Recipes/Recipes.html">Recipes</a>
<ul>  <li><a href="/Courses/Recipes/Basic/Basic.html">Basic</a>
  <ul>  <li><a href="/Courses/Recipes/Basic/Hello/Hello.html">Hello</a></li>
  <li><a href="/Courses/Recipes/Basic/Factorial/Factorial.html">Factorial</a></li>
  <li><a href="/Courses/Recipes/Basic/ColoredTrees/ColoredTrees.html">ColoredTrees</a></li>
  </ul></li>

</ul></li>

</ul>
</div>
</td><td id="tdconcept">
<div id="conceptPane">

<div id="Name">
<span class="sectionHead">Name</span> <a href="javascript:show('Recipes/Basic/ColoredTrees','Recipes/Basic/ColoredTrees')">ColoredTrees</a>
</div>

<div id="searchBox">
  <form method="GET" id="searchForm" action="/search"> 
    <img id="searchIcon" height="20" width="20" src="/images/magnify.png">
    <input type="hidden" name="concept" value="Recipes/Basic/ColoredTrees">
    <input type="text" id="searchField" name="term" autocomplete="off"><br />
    <div id="popups"></div>
  </form>
</div>
         
<div id="Synopsis">
<span class="sectionHead">Synopsis</span>  Computations on binary trees.

</div>

<div id="Description">
<span class="sectionHead">Description</span>  We consider binary trees---trees with exactly two children---that have integers as their leaves. 
 Our trees can have red and black nodes and we want to perform the following operations on them:
 <ul><li> Count the number of red nodes.</li>
<li> Compute the sum of all the integers that occur in the leaves.</li>
<li> Extend the tree data type with green nodes.</li>
<li> Replace all red nodes by green ones.</li>
</ul>
</div>

<div id="Examples">
<span class="sectionHead">Examples</span>  The definition of ColoredTrees is as follows:
 <pre class="listing">@license{
  Copyright (c) 2009-2011 CWI
  All rights reserved. This program and the accompanying materials
  are made available under the terms of the Eclipse Public License v1.0
  which accompanies this distribution, and is available at
  http://www.eclipse.org/legal/epl-v10.html
}
@contributor{Jurgen J. Vinju - Jurgen.Vinju@cwi.nl - CWI}
@contributor{Paul Klint - Paul.Klint@cwi.nl - CWI}
module demo::ColoredTrees

// Define ColoredTrees with red and black nodes and integer leaves

data ColoredTree = leaf(int N)      <img src="images/1.png">
                 | red(ColoredTree left, ColoredTree right) 
                 | black(ColoredTree left, ColoredTree right);
          
// Count the number of red nodes
          
public int cntRed(ColoredTree t){
   int c = 0;
   visit(t) {
     case red(_,_): c = c + 1;      <img src="images/2.png">
   };
   return c;
}

// Compute the sum of all integer leaves

public int addLeaves(ColoredTree t){
   int c = 0;
   visit(t) {
     case leaf(int N): c = c + N;   <img src="images/3.png">
   };
   return c;
}

// Add green nodes to ColoredTree

data ColoredTree = green(ColoredTree left, ColoredTree right); <img src="images/4.png">

// Transform red nodes into green nodes

public ColoredTree makeGreen(ColoredTree t){
   return visit(t) {
     case red(l, r) => green(l, r)   <img src="images/5.png">
   };
}
</pre> First (<img src="/images/1.png">) we define the data type of <code>ColoredTrees</code> with constructors
 <code>leaf</code>, <code>red</code> and <code>black</code>.
 <code>cntRed</code> (<img src="/images/2.png">) counts all red nodes by visiting all nodes and incrementing
 the counter <code>c</code> for each red one.
 <code>addLeaves</code> (<img src="/images/3.png">) visits all nodes and adds the integers in each leaf node.
 In <img src="/images/4.png"> <code>coloredTrees</code> are extended with a new constructor <code>green</code>.
 <code>makeGreen</code> (<img src="/images/5.png">) visits all nodes and turns red nodes in green ones.
 <br/>
<br/>

 We can now explore ColoredTrees:
 <pre class="screen"><b>rascal></b>import demo::ColoredTrees;
ok
<b>rascal></b>rb = red(black(leaf(1), red(leaf(2),leaf(3))), black(leaf(3), leaf(4)));
ColoredTree: red(
  black(
    leaf(1),
    red(
      leaf(2),
      leaf(3))),
  black(
    leaf(3),
    leaf(4)))
</pre>
  Count the red nodes in <code>rb</code>:

<pre class="screen"><b>rascal></b>cntRed(rb);
int: 2
</pre>
  and compute the sum of all leaves:

<pre class="screen"><b>rascal></b>addLeaves(rb);
int: 13
</pre>
  Finally, we convert all red nodes:

<pre class="screen"><b>rascal></b>makeGreen(rb);
ColoredTree: green(
  black(
    leaf(1),
    green(
      leaf(2),
      leaf(3))),
  black(
    leaf(3),
    leaf(4)))
</pre>
</div>

<div id="Benefits">
<span class="sectionHead">Benefits</span>  This example illustrates the fully automatic visiting of the elements of a structured data type.
 Compare this with the traditional programming style in which a switch statement is used to determine
 the constructor and recursion is used to visit substructures. This style becomes particularly cumbersome
 for data types with large numbers of constructors such as, for instance, abstract syntax trees for real
 programming languages.

</div>

<div id="Pitfalls">
<span class="sectionHead">Pitfalls</span>  The visit statement is based on a new paradigm one has to learn.

</div>

<div id="editMenu"><a id="tutorAction" href="/Courses/index.html"><img id="leftIcon" height="40" width="40" src="/images/rascal-tutor-small.png"></a>[<a id="editAction" href="/edit?concept=Recipes/Basic/ColoredTrees&new=false"><b>Edit</b></a>] | 
               [<a id="newAction" href="/edit?concept=Recipes/Basic/ColoredTrees&new=true"><b>New Subconcept</b></a>] |
               [<a id="compileAction" href="/compile?name=Recipes"><b>Compile Course</b></a>] |
               [<a id="compileAction" href="/compile?name=Recipes&flags=regenerate"><b>Recompile Course</b></a>] |
               [<a id="warnAction" href="/Courses/Recipes/warnings.html"><b>Warnings</b></a>]</div>

</div>
</td></tr></table>
</body>
</html>